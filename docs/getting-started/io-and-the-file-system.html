<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>IO and the file system - Elixir</title>
  <link href="http://feeds.feedburner.com/ElixirLang" rel="alternate" title="Elixir's Blog" type="application/atom+xml" />
  <link rel="stylesheet" type="text/css" href="/css/style.css" />
  <link rel="stylesheet" type="text/css" href="/css/syntax.css" />
  <link rel="stylesheet" href="/js/icons/style.css">
  <!--[if lt IE 8]><!-->
  <link rel="stylesheet" href="/js/icons/ie7/ie7.css">
  <!--<![endif]-->
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="stylesheet" id="font-bitter-css" href="//fonts.googleapis.com/css?family=Bitter:400,700" type="text/css" media="screen" />
  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
  <link rel="search" type="application/opensearchdescription+xml" title="elixir-lang.org" href="/opensearch.xml" />
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-8268430-6', 'auto');
  ga('send', 'pageview');
  </script>
  <!-- Begin Jekyll SEO tag v2.2.3 -->
<meta property="og:title" content="IO and the file system" />
<meta property="og:locale" content="en_US" />
<script type="application/ld+json">
{"@context":"http://schema.org","@type":"WebPage","headline":"IO and the file system","url":"/ja/getting-started/io-and-the-file-system.html"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body class="">
  <div id="container">
    <div class="wrap">
    <div id="header">
      <div id="branding">
        <a id="site-title" href="/" title="Elixir" rel="Home">
          <img class="logo" src="/images/logo/logo.png" alt="Elixir Logo" />
        </a>
      </div>

      <div id="menu-primary" class="menu-container">
        <div class="menu">
          <ul id="menu-primary-items">
            <li class="menu-item home"><a class="spec" href="/">Home</a></li>
            <li class="menu-item install"><a class="spec" href="/install.html">Install</a></li>
            <li class="menu-item getting-started"><a class="spec" href="/getting-started/introduction.html">Guides</a></li>
            <li class="menu-item learning"><a class="spec" href="/learning.html">Learning</a></li>
            <li class="menu-item docs"><a class="spec" href="/docs.html">Docs</a></li>
            <li class="menu-item blog"><a class="spec" href="/blog/">Blog</a></li>
            <li class="menu-item packages"><a class="spec" href="https://hex.pm/">Packages</a></li>
          </ul>
        </div>
      </div>

      <div class="clear"></div>
    </div>

    <div id="main">


<div id="sidebar-primary" class="sidebar">
  <div class="widget news">
  <h3>
    News: <a href="/blog/2017/07/25/elixir-v1-5-0-released/">Elixir v1.5 released</a>
  </h3>
</div>

<div class="widget search">
  <form method="get" id="search-form" class="search-form" action="https://www.google.com/search">
		<div>
			<input class="search-text" type="text" name="q" placeholder="Search..." id="searchfield" aria-label="Search box">
			<input type="hidden" name="sitesearch" value="elixir-lang.org">
			<input class="search-submit button" name="submit" type="submit" value="Search" aria-label="Search button">
		</div>
	</form>
</div>

  <div id="try-elixir" class="widget">
  <a href="https://www.codeschool.com/courses/try-elixir?utm_source=elixir_home&utm_medium=referral">
      <div class="try-elixir-cta">
        <div class="try-elixir-copy">Learn Elixir in your browser for free!</div>
      </div>
  </a>
</div>


  
  
    <div class="widget">
     <h3 class="widget-title">Getting Started</h3>
      <ol>
        
          <li><a class="spec" href="/getting-started/introduction.html" title="Introduction">Introduction</a></li>
        
          <li><a class="spec" href="/getting-started/basic-types.html" title="Basic types">Basic types</a></li>
        
          <li><a class="spec" href="/getting-started/basic-operators.html" title="Basic operators">Basic operators</a></li>
        
          <li><a class="spec" href="/getting-started/pattern-matching.html" title="Pattern matching">Pattern matching</a></li>
        
          <li><a class="spec" href="/getting-started/case-cond-and-if.html" title="case, cond and if">case, cond and if</a></li>
        
          <li><a class="spec" href="/getting-started/binaries-strings-and-char-lists.html" title="Binaries, strings and char lists">Binaries, strings and char lists</a></li>
        
          <li><a class="spec" href="/getting-started/keywords-and-maps.html" title="Keywords and maps">Keywords and maps</a></li>
        
          <li><a class="spec" href="/getting-started/modules-and-functions.html" title="Modules and Functions">Modules and Functions</a></li>
        
          <li><a class="spec" href="/getting-started/recursion.html" title="Recursion">Recursion</a></li>
        
          <li><a class="spec" href="/getting-started/enumerables-and-streams.html" title="Enumerables and streams">Enumerables and streams</a></li>
        
          <li><a class="spec" href="/getting-started/processes.html" title="Processes">Processes</a></li>
        
          <li><a class="spec" href="/getting-started/io-and-the-file-system.html" title="IO and the file system">IO and the file system</a></li>
        
          <li><a class="spec" href="/getting-started/alias-require-and-import.html" title="alias, require and import">alias, require and import</a></li>
        
          <li><a class="spec" href="/getting-started/module-attributes.html" title="Module attributes">Module attributes</a></li>
        
          <li><a class="spec" href="/getting-started/structs.html" title="Structs">Structs</a></li>
        
          <li><a class="spec" href="/getting-started/protocols.html" title="Protocols">Protocols</a></li>
        
          <li><a class="spec" href="/getting-started/comprehensions.html" title="Comprehensions">Comprehensions</a></li>
        
          <li><a class="spec" href="/getting-started/sigils.html" title="Sigils">Sigils</a></li>
        
          <li><a class="spec" href="/getting-started/try-catch-and-rescue.html" title="try, catch and rescue">try, catch and rescue</a></li>
        
          <li><a class="spec" href="/getting-started/typespecs-and-behaviours.html" title="Typespecs and behaviours">Typespecs and behaviours</a></li>
        
          <li><a class="spec" href="/getting-started/erlang-libraries.html" title="Erlang libraries">Erlang libraries</a></li>
        
          <li><a class="spec" href="/getting-started/where-to-go-next.html" title="Where to go next">Where to go next</a></li>
        
      </ol>
    </div>
  
    <div class="widget">
     <h3 class="widget-title">Mix and OTP</h3>
      <ol>
        
          <li><a class="spec" href="/getting-started/mix-otp/introduction-to-mix.html" title="Introduction to Mix">Introduction to Mix</a></li>
        
          <li><a class="spec" href="/getting-started/mix-otp/agent.html" title="Agent">Agent</a></li>
        
          <li><a class="spec" href="/getting-started/mix-otp/genserver.html" title="GenServer">GenServer</a></li>
        
          <li><a class="spec" href="/getting-started/mix-otp/supervisor-and-application.html" title="Supervisor and Application">Supervisor and Application</a></li>
        
          <li><a class="spec" href="/getting-started/mix-otp/ets.html" title="ETS">ETS</a></li>
        
          <li><a class="spec" href="/getting-started/mix-otp/dependencies-and-umbrella-apps.html" title="Dependencies and umbrella apps">Dependencies and umbrella apps</a></li>
        
          <li><a class="spec" href="/getting-started/mix-otp/task-and-gen-tcp.html" title="Task and gen-tcp">Task and gen-tcp</a></li>
        
          <li><a class="spec" href="/getting-started/mix-otp/docs-tests-and-with.html" title="Docs, tests and with">Docs, tests and with</a></li>
        
          <li><a class="spec" href="/getting-started/mix-otp/distributed-tasks-and-configuration.html" title="Distributed tasks and configuration">Distributed tasks and configuration</a></li>
        
      </ol>
    </div>
  
    <div class="widget">
     <h3 class="widget-title">Meta-programming in Elixir</h3>
      <ol>
        
          <li><a class="spec" href="/getting-started/meta/quote-and-unquote.html" title="Quote and unquote">Quote and unquote</a></li>
        
          <li><a class="spec" href="/getting-started/meta/macros.html" title="Macros">Macros</a></li>
        
          <li><a class="spec" href="/getting-started/meta/domain-specific-languages.html" title="Domain Specific Languages">Domain Specific Languages</a></li>
        
      </ol>
    </div>
  

  <div id="elixir-radar" class="widget">
  <h3 class="widget-title">Elixir Radar Newsletter</h3>
  <p>A weekly Elixir email newsletter with content curated by Plataformatec.</p>
  <div class="elixir-radar-cta">
    <div class="cta-copy">
      <div class="cta-title">
        Elixir Radar
      </div>
      <div class="cta-subtitle">
        weekly newsletter
      </div>
    </div>
    <div class="cta-button-container">
      <a href="http://plataformatec.com.br/elixir-radar/weekly-newsletter?utm_campaign=elixir_lang_cta&utm_medium=cta&utm_source=elixir_lang_website" class="cta-button">
        Subscribe now
      </a>
    </div>
  </div>
</div>

  <div id="distilled-by" class="widget">
  <h3 class="widget-title">Created at</h3>
  <ul>
    <li class="image"><a href="http://plataformatec.com.br" title="Plataformatec"><img src="/images/logo/plataformatec.png" alt="Plataformatec Logo" width="190" height="74" /></a></li>
  </ul>

  <p>
    <a class="spec" href="http://plataformatec.com.br">Plataformatec</a> offers consulting and development services for companies using Elixir.
  </p>
</div>

</div>

<div id="content">
  <article>
    <h1 id="io-and-the-file-system">IO and the file system</h1>

<div id="toc" class="toc"></div>

<p>This chapter is a quick introduction to input/output mechanisms and file-system-related tasks, as well as to related modules like <a href="https://hexdocs.pm/elixir/IO.html"><code class="highlighter-rouge">IO</code></a>, <a href="https://hexdocs.pm/elixir/File.html"><code class="highlighter-rouge">File</code></a> and <a href="https://hexdocs.pm/elixir/Path.html"><code class="highlighter-rouge">Path</code></a>.</p>

<p>We had originally sketched this chapter to come much earlier in the getting started guide. However, we noticed the IO system provides a great opportunity to shed some light on some philosophies and curiosities of Elixir and the <abbr title="Virtual Machine">VM</abbr>.</p>

<h2 id="the-io-module">The <code class="highlighter-rouge">IO</code> module</h2>

<p>The <a href="http://elixir-lang.org/docs/v1.0/elixir/IO.html"><code class="highlighter-rouge">IO</code></a> module is the main mechanism in Elixir for reading and writing to standard input/output (<code class="highlighter-rouge">:stdio</code>), standard error (<code class="highlighter-rouge">:stderr</code>), files, and other IO devices. Usage of the module is pretty straightforward:</p>

<pre><code class="language-iex">iex&gt; IO.puts "hello world"
hello world
:ok
iex&gt; IO.gets "yes or no? "
yes or no? yes
"yes\n"
</code></pre>

<p>By default, functions in the <code class="highlighter-rouge">IO</code> module read from the standard input and write to the standard output. We can change that by passing, for example, <code class="highlighter-rouge">:stderr</code> as an argument (in order to write to the standard error device):</p>

<pre><code class="language-iex">iex&gt; IO.puts :stderr, "hello world"
hello world
:ok
</code></pre>

<h2 id="the-file-module">The <code class="highlighter-rouge">File</code> module</h2>

<p>The <a href="https://hexdocs.pm/elixir/File.html"><code class="highlighter-rouge">File</code></a> module contains functions that allow us to open files as IO devices. By default, files are opened in binary mode, which requires developers to use the specific <code class="highlighter-rouge">IO.binread/2</code> and <code class="highlighter-rouge">IO.binwrite/2</code> functions from the <code class="highlighter-rouge">IO</code> module:</p>

<pre><code class="language-iex">iex&gt; {:ok, file} = File.open "hello", [:write]
{:ok, #PID&lt;0.47.0&gt;}
iex&gt; IO.binwrite file, "world"
:ok
iex&gt; File.close file
:ok
iex&gt; File.read "hello"
{:ok, "world"}
</code></pre>

<p>A file can also be opened with <code class="highlighter-rouge">:utf8</code> encoding, which tells the <code class="highlighter-rouge">File</code> module to interpret the bytes read from the file as UTF-8-encoded bytes.</p>

<p>Besides functions for opening, reading and writing files, the <code class="highlighter-rouge">File</code> module has many functions to work with the file system. Those functions are named after their UNIX equivalents. For example, <code class="highlighter-rouge">File.rm/1</code> can be used to remove files, <code class="highlighter-rouge">File.mkdir/1</code> to create directories, <code class="highlighter-rouge">File.mkdir_p/1</code> to create directories and all their parent chain. There are even <code class="highlighter-rouge">File.cp_r/2</code> and <code class="highlighter-rouge">File.rm_rf/1</code> to respectively copy and remove files and directories recursively (i.e., copying and removing the contents of the directories too).</p>

<p>You will also notice that functions in the <code class="highlighter-rouge">File</code> module have two variants: one “regular” variant and another variant with a trailing bang (<code class="highlighter-rouge">!</code>). For example, when we read the <code class="highlighter-rouge">"hello"</code> file in the example above, we use <code class="highlighter-rouge">File.read/1</code>. Alternatively, we can use <code class="highlighter-rouge">File.read!/1</code>:</p>

<pre><code class="language-iex">iex&gt; File.read "hello"
{:ok, "world"}
iex&gt; File.read! "hello"
"world"
iex&gt; File.read "unknown"
{:error, :enoent}
iex&gt; File.read! "unknown"
** (File.Error) could not read file "unknown": no such file or directory
</code></pre>

<p>Notice that the version with <code class="highlighter-rouge">!</code> returns the contents of the file instead of a tuple, and if anything goes wrong the function raises an error.</p>

<p>The version without <code class="highlighter-rouge">!</code> is preferred when you want to handle different outcomes using pattern matching:</p>

<div class="language-elixir highlighter-rouge"><pre class="highlight"><code><span class="k">case</span> <span class="no">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">file</span><span class="p">)</span> <span class="k">do</span>
  <span class="p">{</span><span class="ss">:ok</span><span class="p">,</span> <span class="n">body</span><span class="p">}</span>      <span class="o">-&gt;</span> <span class="c1"># do something with the `body`</span>
  <span class="p">{</span><span class="ss">:error</span><span class="p">,</span> <span class="n">reason</span><span class="p">}</span> <span class="o">-&gt;</span> <span class="c1"># handle the error caused by `reason`</span>
<span class="k">end</span>
</code></pre>
</div>

<p>However, if you expect the file to be there, the bang variation is more useful as it raises a meaningful error message. Avoid writing:</p>

<div class="language-elixir highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="ss">:ok</span><span class="p">,</span> <span class="n">body</span><span class="p">}</span> <span class="o">=</span> <span class="no">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
</code></pre>
</div>

<p>as, in case of an error, <code class="highlighter-rouge">File.read/1</code> will return <code class="highlighter-rouge"><span class="p">{</span><span class="err">:error,</span><span class="w"> </span><span class="err">reason</span><span class="p">}</span></code> and the pattern matching will fail. You will still get the desired result (a raised error), but the message will be about the pattern which doesn’t match (thus being cryptic in respect to what the error actually is about).</p>

<p>Therefore, if you don’t want to handle the error outcomes, prefer using <code class="highlighter-rouge">File.read!/1</code>.</p>

<h2 id="the-path-module">The <code class="highlighter-rouge">Path</code> module</h2>

<p>The majority of the functions in the <code class="highlighter-rouge">File</code> module expect paths as arguments. Most commonly, those paths will be regular binaries. The <a href="https://hexdocs.pm/elixir/Path.html"><code class="highlighter-rouge">Path</code></a> module provides facilities for working with such paths:</p>

<pre><code class="language-iex">iex&gt; Path.join("foo", "bar")
"foo/bar"
iex&gt; Path.expand("~/hello")
"/Users/jose/hello"
</code></pre>

<p>Using functions from the <code class="highlighter-rouge">Path</code> module as opposed to directly manipulating strings is preferred since the <code class="highlighter-rouge">Path</code> module takes care of different operating systems transparently. Finally, keep in mind that Elixir will automatically convert slashes (<code class="highlighter-rouge">/</code>) into backslashes (<code class="highlighter-rouge">\</code>) on Windows when performing file operations.</p>

<p>With this we have covered the main modules that Elixir provides for dealing with IO and interacting with the file system. In the next sections, we will discuss some advanced topics regarding IO. Those sections are not necessary in order to write Elixir code, so feel free to skip them, but they do provide a nice overview of how the IO system is implemented in the <abbr title="Virtual Machine">VM</abbr> and other curiosities.</p>

<h2 id="processes-and-group-leaders">Processes and group leaders</h2>

<p>You may have noticed that <code class="highlighter-rouge">File.open/2</code> returns a tuple like <code class="highlighter-rouge"><span class="p">{</span><span class="err">:ok,</span><span class="w"> </span><span class="err">pid</span><span class="p">}</span></code>:</p>

<pre><code class="language-iex">iex&gt; {:ok, file} = File.open "hello", [:write]
{:ok, #PID&lt;0.47.0&gt;}
</code></pre>

<p>That happens because the <code class="highlighter-rouge">IO</code> module actually works with processes (see <a href="/getting-started/processes.html">chapter 11</a>). When you write <code class="highlighter-rouge">IO.write(pid, binary)</code>, the <code class="highlighter-rouge">IO</code> module will send a message to the process identified by <code class="highlighter-rouge">pid</code> with the desired operation. Let’s see what happens if we use our own process:</p>

<pre><code class="language-iex">iex&gt; pid = spawn fn -&gt;
...&gt;  receive do: (msg -&gt; IO.inspect msg)
...&gt; end
#PID&lt;0.57.0&gt;
iex&gt; IO.write(pid, "hello")
{:io_request, #PID&lt;0.41.0&gt;, #Reference&lt;0.0.8.91&gt;,
 {:put_chars, :unicode, "hello"}}
** (ErlangError) erlang error: :terminated
</code></pre>

<p>After <code class="highlighter-rouge">IO.write/2</code>, we can see the request sent by the <code class="highlighter-rouge">IO</code> module (a four-elements tuple) printed out. Soon after that, we see that it fails since the <code class="highlighter-rouge">IO</code> module expected some kind of result that we did not supply.</p>

<p>The <a href="https://hexdocs.pm/elixir/StringIO.html"><code class="highlighter-rouge">StringIO</code></a> module provides an implementation of the <code class="highlighter-rouge">IO</code> device messages on top of strings:</p>

<pre><code class="language-iex">iex&gt; {:ok, pid} = StringIO.open("hello")
{:ok, #PID&lt;0.43.0&gt;}
iex&gt; IO.read(pid, 2)
"he"
</code></pre>

<p>By modelling IO devices with processes, the Erlang <abbr title="Virtual Machine">VM</abbr> allows different nodes in the same network to exchange file processes in order to read/write files in between nodes. Of all IO devices, there is one that is special to each process: the <strong>group leader</strong>.</p>

<p>When you write to <code class="highlighter-rouge">:stdio</code>, you are actually sending a message to the group leader, which writes to the standard-output file descriptor:</p>

<pre><code class="language-iex">iex&gt; IO.puts :stdio, "hello"
hello
:ok
iex&gt; IO.puts Process.group_leader, "hello"
hello
:ok
</code></pre>

<p>The group leader can be configured per process and is used in different situations. For example, when executing code in a remote terminal, it guarantees messages in a remote node are redirected and printed in the terminal that triggered the request.</p>

<h2 id="iodata-and-chardata"><code class="highlighter-rouge">iodata</code> and <code class="highlighter-rouge">chardata</code></h2>

<p>In all of the examples above, we used binaries when writing to files. In the chapter <a href="/getting-started/binaries-strings-and-char-lists.html">“Binaries, strings and char lists”</a>, we mentioned how strings are made of bytes while char lists are lists with unicode codepoints.</p>

<p>The functions in <code class="highlighter-rouge">IO</code> and <code class="highlighter-rouge">File</code> also allow lists to be given as arguments. Not only that, they also allow a mixed list of lists, integers and binaries to be given:</p>

<pre><code class="language-iex">iex&gt; IO.puts 'hello world'
hello world
:ok
iex&gt; IO.puts ['hello', ?\s, "world"]
hello world
:ok
</code></pre>

<p>However, using list in IO operations requires some attention. A list may represent either a bunch of bytes or a bunch of characters and which one to use depends on the encoding of the IO device. If the file is opened without encoding, the file is expected to be in raw mode, and the functions in the <code class="highlighter-rouge">IO</code> module starting with <code class="highlighter-rouge">bin*</code> must be used. Those functions expect an <code class="highlighter-rouge">iodata</code> as argument; i.e., they expect a list of integers representing bytes and binaries to be given.</p>

<p>On the other hand, <code class="highlighter-rouge">:stdio</code> and files opened with <code class="highlighter-rouge">:utf8</code> encoding work with the remaining functions in the <code class="highlighter-rouge">IO</code> module. Those functions expect a <code class="highlighter-rouge">char_data</code> as an argument, that is, a list of characters or strings.</p>

<p>Although this is a subtle difference, you only need to worry about these details if you intend to pass lists to those functions. Binaries are already represented by the underlying bytes and as such their representation is always “raw”.</p>

<p>This finishes our tour of IO devices and IO related functionality. We have learned about four Elixir modules - <a href="https://hexdocs.pm/elixir/IO.html"><code class="highlighter-rouge">IO</code></a>, <a href="https://hexdocs.pm/elixir/File.html"><code class="highlighter-rouge">File</code></a>, <a href="https://hexdocs.pm/elixir/Path.html"><code class="highlighter-rouge">Path</code></a> and <a href="https://hexdocs.pm/elixir/StringIO.html"><code class="highlighter-rouge">StringIO</code></a> - as well as how the <abbr title="Virtual Machine">VM</abbr> uses processes for the underlying IO mechanisms and how to use <code class="highlighter-rouge">chardata</code> and <code class="highlighter-rouge">iodata</code> for IO operations.</p>

  </article><!-- .hfeed -->

  <div id="edit-on-github">
    <span>Is something wrong?</span>
    <a href="/edit/master/ja/getting-started/io-and-the-file-system.markdown">
      Edit this page on GitHub.
    </a>
  </div>

  
  
  
  
  

  
  
    
  
    
  
    
  

</div><!-- #content -->

      </div><!-- #main -->

      <div class="clear"></div>

      <div id="copyright">
        &copy; 2012–2017 <a href="http://plataformatec.com.br/">Plataformatec</a>. All rights reserved.
      </div>
    </div><!-- .wrap -->
  </div><!-- #container -->

  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <script src="/js/toc/toc.js" type="text/javascript" charset="utf-8"></script>
  <script type="text/javascript">
    $(document).ready(function() {
      $('.toc').toc({
        title: '',
        listType: 'ol',
        minimumHeaders: 2,
        headers: 'h2, h3, h4, h5, h6',
        linkHere: true,
        linkHereTitle: 'Link here',
        backToTop: true,
        backToTopId: 'toc',
        backToTopTitle: 'Back to Table of Contents',
      });
      $('.jekyll-toc-header a.jekyll-toc-link-here span.jekyll-toc-icon').addClass('icon icon-link');
      $('.jekyll-toc-header a.jekyll-toc-back-to-top span.jekyll-toc-icon').addClass('icon icon-chevron-up');
    });
  </script>
</body>
</html>

