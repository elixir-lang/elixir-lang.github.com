<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Enumerables and Streams - Elixir</title>
  <link href="http://feeds.feedburner.com/ElixirLang" rel="alternate" title="Elixir's Blog" type="application/atom+xml" />
  <link rel="stylesheet" type="text/css" href="/css/style.css" />
  <link rel="stylesheet" type="text/css" href="/css/syntax.css" />
  <link rel="stylesheet" href="/js/icons/style.css">
  <!--[if lt IE 8]><!-->
  <link rel="stylesheet" href="/js/icons/ie7/ie7.css">
  <!--<![endif]-->
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="stylesheet" id="font-bitter-css" href="//fonts.googleapis.com/css?family=Bitter:400,700" type="text/css" media="screen" />
  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
  <link rel="search" type="application/opensearchdescription+xml" title="elixir-lang.org" href="/opensearch.xml" />
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-8268430-6', 'auto');
  ga('send', 'pageview');
  </script>
  <!-- Begin Jekyll SEO tag v2.2.3 -->
<meta property="og:title" content="Enumerables and Streams" />
<meta property="og:locale" content="en_US" />
<script type="application/ld+json">
{"@context":"http://schema.org","@type":"WebPage","headline":"Enumerables and Streams","url":"/ja/getting-started/enumerables-and-streams.html"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body class="">
  <div id="container">
    <div class="wrap">
    <div id="header">
      <div id="branding">
        <a id="site-title" href="/" title="Elixir" rel="Home">
          <img class="logo" src="/images/logo/logo.png" alt="Elixir Logo" />
        </a>
      </div>

      <div id="menu-primary" class="menu-container">
        <div class="menu">
          <ul id="menu-primary-items">
            <li class="menu-item home"><a class="spec" href="/">Home</a></li>
            <li class="menu-item install"><a class="spec" href="/install.html">Install</a></li>
            <li class="menu-item getting-started"><a class="spec" href="/getting-started/introduction.html">Guides</a></li>
            <li class="menu-item learning"><a class="spec" href="/learning.html">Learning</a></li>
            <li class="menu-item docs"><a class="spec" href="/docs.html">Docs</a></li>
            <li class="menu-item blog"><a class="spec" href="/blog/">Blog</a></li>
            <li class="menu-item packages"><a class="spec" href="https://hex.pm/">Packages</a></li>
          </ul>
        </div>
      </div>

      <div class="clear"></div>
    </div>

    <div id="main">


<div id="sidebar-primary" class="sidebar">
  <div class="widget news">
  <h3>
    News: <a href="/blog/2017/07/25/elixir-v1-5-0-released/">Elixir v1.5 released</a>
  </h3>
</div>

<div class="widget search">
  <form method="get" id="search-form" class="search-form" action="https://www.google.com/search">
		<div>
			<input class="search-text" type="text" name="q" placeholder="Search..." id="searchfield" aria-label="Search box">
			<input type="hidden" name="sitesearch" value="elixir-lang.org">
			<input class="search-submit button" name="submit" type="submit" value="Search" aria-label="Search button">
		</div>
	</form>
</div>

  <div id="try-elixir" class="widget">
  <a href="https://www.codeschool.com/courses/try-elixir?utm_source=elixir_home&utm_medium=referral">
      <div class="try-elixir-cta">
        <div class="try-elixir-copy">Learn Elixir in your browser for free!</div>
      </div>
  </a>
</div>


  
  
    <div class="widget">
     <h3 class="widget-title">Getting Started</h3>
      <ol>
        
          <li><a class="spec" href="/getting-started/introduction.html" title="Introduction">Introduction</a></li>
        
          <li><a class="spec" href="/getting-started/basic-types.html" title="Basic types">Basic types</a></li>
        
          <li><a class="spec" href="/getting-started/basic-operators.html" title="Basic operators">Basic operators</a></li>
        
          <li><a class="spec" href="/getting-started/pattern-matching.html" title="Pattern matching">Pattern matching</a></li>
        
          <li><a class="spec" href="/getting-started/case-cond-and-if.html" title="case, cond and if">case, cond and if</a></li>
        
          <li><a class="spec" href="/getting-started/binaries-strings-and-char-lists.html" title="Binaries, strings and char lists">Binaries, strings and char lists</a></li>
        
          <li><a class="spec" href="/getting-started/keywords-and-maps.html" title="Keywords and maps">Keywords and maps</a></li>
        
          <li><a class="spec" href="/getting-started/modules-and-functions.html" title="Modules and Functions">Modules and Functions</a></li>
        
          <li><a class="spec" href="/getting-started/recursion.html" title="Recursion">Recursion</a></li>
        
          <li><a class="spec" href="/getting-started/enumerables-and-streams.html" title="Enumerables and streams">Enumerables and streams</a></li>
        
          <li><a class="spec" href="/getting-started/processes.html" title="Processes">Processes</a></li>
        
          <li><a class="spec" href="/getting-started/io-and-the-file-system.html" title="IO and the file system">IO and the file system</a></li>
        
          <li><a class="spec" href="/getting-started/alias-require-and-import.html" title="alias, require and import">alias, require and import</a></li>
        
          <li><a class="spec" href="/getting-started/module-attributes.html" title="Module attributes">Module attributes</a></li>
        
          <li><a class="spec" href="/getting-started/structs.html" title="Structs">Structs</a></li>
        
          <li><a class="spec" href="/getting-started/protocols.html" title="Protocols">Protocols</a></li>
        
          <li><a class="spec" href="/getting-started/comprehensions.html" title="Comprehensions">Comprehensions</a></li>
        
          <li><a class="spec" href="/getting-started/sigils.html" title="Sigils">Sigils</a></li>
        
          <li><a class="spec" href="/getting-started/try-catch-and-rescue.html" title="try, catch and rescue">try, catch and rescue</a></li>
        
          <li><a class="spec" href="/getting-started/typespecs-and-behaviours.html" title="Typespecs and behaviours">Typespecs and behaviours</a></li>
        
          <li><a class="spec" href="/getting-started/erlang-libraries.html" title="Erlang libraries">Erlang libraries</a></li>
        
          <li><a class="spec" href="/getting-started/where-to-go-next.html" title="Where to go next">Where to go next</a></li>
        
      </ol>
    </div>
  
    <div class="widget">
     <h3 class="widget-title">Mix and OTP</h3>
      <ol>
        
          <li><a class="spec" href="/getting-started/mix-otp/introduction-to-mix.html" title="Introduction to Mix">Introduction to Mix</a></li>
        
          <li><a class="spec" href="/getting-started/mix-otp/agent.html" title="Agent">Agent</a></li>
        
          <li><a class="spec" href="/getting-started/mix-otp/genserver.html" title="GenServer">GenServer</a></li>
        
          <li><a class="spec" href="/getting-started/mix-otp/supervisor-and-application.html" title="Supervisor and Application">Supervisor and Application</a></li>
        
          <li><a class="spec" href="/getting-started/mix-otp/ets.html" title="ETS">ETS</a></li>
        
          <li><a class="spec" href="/getting-started/mix-otp/dependencies-and-umbrella-apps.html" title="Dependencies and umbrella apps">Dependencies and umbrella apps</a></li>
        
          <li><a class="spec" href="/getting-started/mix-otp/task-and-gen-tcp.html" title="Task and gen-tcp">Task and gen-tcp</a></li>
        
          <li><a class="spec" href="/getting-started/mix-otp/docs-tests-and-with.html" title="Docs, tests and with">Docs, tests and with</a></li>
        
          <li><a class="spec" href="/getting-started/mix-otp/distributed-tasks-and-configuration.html" title="Distributed tasks and configuration">Distributed tasks and configuration</a></li>
        
      </ol>
    </div>
  
    <div class="widget">
     <h3 class="widget-title">Meta-programming in Elixir</h3>
      <ol>
        
          <li><a class="spec" href="/getting-started/meta/quote-and-unquote.html" title="Quote and unquote">Quote and unquote</a></li>
        
          <li><a class="spec" href="/getting-started/meta/macros.html" title="Macros">Macros</a></li>
        
          <li><a class="spec" href="/getting-started/meta/domain-specific-languages.html" title="Domain Specific Languages">Domain Specific Languages</a></li>
        
      </ol>
    </div>
  

  <div id="elixir-radar" class="widget">
  <h3 class="widget-title">Elixir Radar Newsletter</h3>
  <p>A weekly Elixir email newsletter with content curated by Plataformatec.</p>
  <div class="elixir-radar-cta">
    <div class="cta-copy">
      <div class="cta-title">
        Elixir Radar
      </div>
      <div class="cta-subtitle">
        weekly newsletter
      </div>
    </div>
    <div class="cta-button-container">
      <a href="http://plataformatec.com.br/elixir-radar/weekly-newsletter?utm_campaign=elixir_lang_cta&utm_medium=cta&utm_source=elixir_lang_website" class="cta-button">
        Subscribe now
      </a>
    </div>
  </div>
</div>

  <div id="distilled-by" class="widget">
  <h3 class="widget-title">Created at</h3>
  <ul>
    <li class="image"><a href="http://plataformatec.com.br" title="Plataformatec"><img src="/images/logo/plataformatec.png" alt="Plataformatec Logo" width="190" height="74" /></a></li>
  </ul>

  <p>
    <a class="spec" href="http://plataformatec.com.br">Plataformatec</a> offers consulting and development services for companies using Elixir.
  </p>
</div>

</div>

<div id="content">
  <article>
    <h1 id="enumerables-and-streams">Enumerables and Streams</h1>

<div id="toc" class="toc"></div>

<h2 id="enumerables">Enumerables</h2>

<p>Elixir provides the concept of enumerables and <a href="https://hexdocs.pm/elixir/Enum.html">the <code class="highlighter-rouge">Enum</code> module</a> to work with them. We have already learned two enumerables: lists and maps.</p>

<pre><code class="language-iex">iex&gt; Enum.map([1, 2, 3], fn x -&gt; x * 2 end)
[2, 4, 6]
iex&gt; Enum.map(%{1 =&gt; 2, 3 =&gt; 4}, fn {k, v} -&gt; k * v end)
[2, 12]
</code></pre>

<p>The <code class="highlighter-rouge">Enum</code> module provides a huge range of functions to transform, sort, group, filter and retrieve items from enumerables. It is one of the modules developers use frequently in their Elixir code.</p>

<p>Elixir also provides ranges:</p>

<pre><code class="language-iex">iex&gt; Enum.map(1..3, fn x -&gt; x * 2 end)
[2, 4, 6]
iex&gt; Enum.reduce(1..3, 0, &amp;+/2)
6
</code></pre>

<p>The functions in the Enum module are limited to, as the name says, enumerating values in data structures. For specific operations, like inserting and updating particular elements, you may need to reach for modules specific to the data type. For example, if you want to insert an element at a given position in a list, you should use the <code class="highlighter-rouge">List.insert_at/3</code> function from <a href="https://hexdocs.pm/elixir/List.html">the <code class="highlighter-rouge">List</code> module</a>, as it would make little sense to insert a value into, for example, a range.</p>

<p>We say the functions in the <code class="highlighter-rouge">Enum</code> module are polymorphic because they can work with diverse data types. In particular, the functions in the <code class="highlighter-rouge">Enum</code> module can work with any data type that implements <a href="https://hexdocs.pm/elixir/Enumerable.html">the <code class="highlighter-rouge">Enumerable</code> protocol</a>. We are going to discuss Protocols in a later chapter; for now we are going to move on to a specific kind of enumerable called a stream.</p>

<h2 id="eager-vs-lazy">Eager vs Lazy</h2>

<p>All the functions in the <code class="highlighter-rouge">Enum</code> module are eager. Many functions expect an enumerable and return a list back:</p>

<pre><code class="language-iex">iex&gt; odd? = &amp;(rem(&amp;1, 2) != 0)
#Function&lt;6.80484245/1 in :erl_eval.expr/5&gt;
iex&gt; Enum.filter(1..3, odd?)
[1, 3]
</code></pre>

<p>This means that when performing multiple operations with <code class="highlighter-rouge">Enum</code>, each operation is going to generate an intermediate list until we reach the result:</p>

<pre><code class="language-iex">iex&gt; 1..100_000 |&gt; Enum.map(&amp;(&amp;1 * 3)) |&gt; Enum.filter(odd?) |&gt; Enum.sum
7500000000
</code></pre>

<p>The example above has a pipeline of operations. We start with a range and then multiply each element in the range by 3. This first operation will now create and return a list with <code class="highlighter-rouge">100_000</code> items. Then we keep all odd elements from the list, generating a new list, now with <code class="highlighter-rouge">50_000</code> items, and then we sum all entries.</p>

<h2 id="the-pipe-operator">The pipe operator</h2>

<p>The <code class="highlighter-rouge">|&gt;</code> symbol used in the snippet above is the <strong>pipe operator</strong>: it takes the output from the expression on its left side and passes it as the first argument to the function call on its right side. It’s similar to the Unix <code class="highlighter-rouge">|</code> operator.  Its purpose is to highlight the data being transformed by a series of functions. To see how it can make the code cleaner, have a look at the example above rewritten without using the <code class="highlighter-rouge">|&gt;</code> operator:</p>

<pre><code class="language-iex">iex&gt; Enum.sum(Enum.filter(Enum.map(1..100_000, &amp;(&amp;1 * 3)), odd?))
7500000000
</code></pre>

<p>Find more about the pipe operator <a href="https://hexdocs.pm/elixir/Kernel.html#%7C%3E/2">by reading its documentation</a>.</p>

<h2 id="streams">Streams</h2>

<p>As an alternative to <code class="highlighter-rouge">Enum</code>, Elixir provides <a href="https://hexdocs.pm/elixir/Stream.html">the <code class="highlighter-rouge">Stream</code> module</a> which supports lazy operations:</p>

<pre><code class="language-iex">iex&gt; 1..100_000 |&gt; Stream.map(&amp;(&amp;1 * 3)) |&gt; Stream.filter(odd?) |&gt; Enum.sum
7500000000
</code></pre>

<p>Streams are lazy, composable enumerables.</p>

<p>In the example above, <code class="highlighter-rouge">1..100_000 |&gt; Stream.map(&amp;(&amp;1 * 3))</code> returns a data type, an actual stream, that represents the <code class="highlighter-rouge">map</code> computation over the range <code class="highlighter-rouge">1..100_000</code>:</p>

<pre><code class="language-iex">iex&gt; 1..100_000 |&gt; Stream.map(&amp;(&amp;1 * 3))
#Stream&lt;[enum: 1..100000, funs: [#Function&lt;34.16982430/1 in Stream.map/2&gt;]]&gt;
</code></pre>

<p>Furthermore, they are composable because we can pipe many stream operations:</p>

<pre><code class="language-iex">iex&gt; 1..100_000 |&gt; Stream.map(&amp;(&amp;1 * 3)) |&gt; Stream.filter(odd?)
#Stream&lt;[enum: 1..100000, funs: [...]]&gt;
</code></pre>

<p>Instead of generating intermediate lists, streams build a series of computations that are invoked only when we pass the underlying stream to the <code class="highlighter-rouge">Enum</code> module. Streams are useful when working with large, <em>possibly infinite</em>, collections.</p>

<p>Many functions in the <code class="highlighter-rouge">Stream</code> module accept any enumerable as an argument and return a stream as a result. It also provides functions for creating streams. For example, <code class="highlighter-rouge">Stream.cycle/1</code> can be used to create a stream that cycles a given enumerable infinitely. Be careful to not call a function like <code class="highlighter-rouge">Enum.map/2</code> on such streams, as they would cycle forever:</p>

<pre><code class="language-iex">iex&gt; stream = Stream.cycle([1, 2, 3])
#Function&lt;15.16982430/2 in Stream.cycle/1&gt;
iex&gt; Enum.take(stream, 10)
[1, 2, 3, 1, 2, 3, 1, 2, 3, 1]
</code></pre>

<p>On the other hand, <code class="highlighter-rouge">Stream.unfold/2</code> can be used to generate values from a given initial value:</p>

<pre><code class="language-iex">iex&gt; stream = Stream.unfold("hełło", &amp;String.next_codepoint/1)
#Function&lt;39.75994740/2 in Stream.unfold/2&gt;
iex&gt; Enum.take(stream, 3)
["h", "e", "ł"]
</code></pre>

<p>Another interesting function is <code class="highlighter-rouge">Stream.resource/3</code> which can be used to wrap around resources, guaranteeing they are opened right before enumeration and closed afterwards, even in the case of failures. For example, we can use it to stream a file:</p>

<pre><code class="language-iex">iex&gt; stream = File.stream!("path/to/file")
#Function&lt;18.16982430/2 in Stream.resource/3&gt;
iex&gt; Enum.take(stream, 10)
</code></pre>

<p>The example above will fetch the first 10 lines of the file you have selected. This means streams can be very useful for handling large files or even slow resources like network resources.</p>

<p>The amount of functionality in the <a href="https://hexdocs.pm/elixir/Enum.html"><code class="highlighter-rouge">Enum</code></a> and <a href="https://hexdocs.pm/elixir/Stream.html"><code class="highlighter-rouge">Stream</code></a> modules can be daunting at first, but you will get familiar with them case by case. In particular, focus on the <code class="highlighter-rouge">Enum</code> module first and only move to <code class="highlighter-rouge">Stream</code> for the particular scenarios where laziness is required, to either deal with slow resources or large, possibly infinite, collections.</p>

<p>Next we’ll look at a feature central to Elixir, Processes, which allows us to write concurrent, parallel and distributed programs in an easy and understandable way.</p>

  </article><!-- .hfeed -->

  <div id="edit-on-github">
    <span>Is something wrong?</span>
    <a href="/edit/master/ja/getting-started/enumerables-and-streams.markdown">
      Edit this page on GitHub.
    </a>
  </div>

  
  
  
  
  

  
  
    
  
    
  
    
  

</div><!-- #content -->

      </div><!-- #main -->

      <div class="clear"></div>

      <div id="copyright">
        &copy; 2012–2017 <a href="http://plataformatec.com.br/">Plataformatec</a>. All rights reserved.
      </div>
    </div><!-- .wrap -->
  </div><!-- #container -->

  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <script src="/js/toc/toc.js" type="text/javascript" charset="utf-8"></script>
  <script type="text/javascript">
    $(document).ready(function() {
      $('.toc').toc({
        title: '',
        listType: 'ol',
        minimumHeaders: 2,
        headers: 'h2, h3, h4, h5, h6',
        linkHere: true,
        linkHereTitle: 'Link here',
        backToTop: true,
        backToTopId: 'toc',
        backToTopTitle: 'Back to Table of Contents',
      });
      $('.jekyll-toc-header a.jekyll-toc-link-here span.jekyll-toc-icon').addClass('icon icon-link');
      $('.jekyll-toc-header a.jekyll-toc-back-to-top span.jekyll-toc-icon').addClass('icon icon-chevron-up');
    });
  </script>
</body>
</html>

