<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Module attributes - Elixir</title>
  <link href="http://feeds.feedburner.com/ElixirLang" rel="alternate" title="Elixir's Blog" type="application/atom+xml" />
  <link rel="stylesheet" type="text/css" href="/css/style.css" />
  <link rel="stylesheet" type="text/css" href="/css/syntax.css" />
  <link rel="stylesheet" href="/js/icons/style.css">
  <!--[if lt IE 8]><!-->
  <link rel="stylesheet" href="/js/icons/ie7/ie7.css">
  <!--<![endif]-->
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="stylesheet" id="font-bitter-css" href="//fonts.googleapis.com/css?family=Bitter:400,700" type="text/css" media="screen" />
  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
  <link rel="search" type="application/opensearchdescription+xml" title="elixir-lang.org" href="/opensearch.xml" />
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-8268430-6', 'auto');
  ga('send', 'pageview');
  </script>
  <!-- Begin Jekyll SEO tag v2.2.3 -->
<meta property="og:title" content="Module attributes" />
<meta property="og:locale" content="en_US" />
<script type="application/ld+json">
{"@context":"http://schema.org","@type":"WebPage","headline":"Module attributes","url":"/ja/getting-started/module-attributes.html"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body class="">
  <div id="container">
    <div class="wrap">
    <div id="header">
      <div id="branding">
        <a id="site-title" href="/" title="Elixir" rel="Home">
          <img class="logo" src="/images/logo/logo.png" alt="Elixir Logo" />
        </a>
      </div>

      <div id="menu-primary" class="menu-container">
        <div class="menu">
          <ul id="menu-primary-items">
            <li class="menu-item home"><a class="spec" href="/">Home</a></li>
            <li class="menu-item install"><a class="spec" href="/install.html">Install</a></li>
            <li class="menu-item getting-started"><a class="spec" href="/getting-started/introduction.html">Guides</a></li>
            <li class="menu-item learning"><a class="spec" href="/learning.html">Learning</a></li>
            <li class="menu-item docs"><a class="spec" href="/docs.html">Docs</a></li>
            <li class="menu-item blog"><a class="spec" href="/blog/">Blog</a></li>
            <li class="menu-item packages"><a class="spec" href="https://hex.pm/">Packages</a></li>
          </ul>
        </div>
      </div>

      <div class="clear"></div>
    </div>

    <div id="main">


<div id="sidebar-primary" class="sidebar">
  <div class="widget news">
  <h3>
    News: <a href="/blog/2017/07/25/elixir-v1-5-0-released/">Elixir v1.5 released</a>
  </h3>
</div>

<div class="widget search">
  <form method="get" id="search-form" class="search-form" action="https://www.google.com/search">
		<div>
			<input class="search-text" type="text" name="q" placeholder="Search..." id="searchfield" aria-label="Search box">
			<input type="hidden" name="sitesearch" value="elixir-lang.org">
			<input class="search-submit button" name="submit" type="submit" value="Search" aria-label="Search button">
		</div>
	</form>
</div>

  <div id="try-elixir" class="widget">
  <a href="https://www.codeschool.com/courses/try-elixir?utm_source=elixir_home&utm_medium=referral">
      <div class="try-elixir-cta">
        <div class="try-elixir-copy">Learn Elixir in your browser for free!</div>
      </div>
  </a>
</div>


  
  
    <div class="widget">
     <h3 class="widget-title">Getting Started</h3>
      <ol>
        
          <li><a class="spec" href="/getting-started/introduction.html" title="Introduction">Introduction</a></li>
        
          <li><a class="spec" href="/getting-started/basic-types.html" title="Basic types">Basic types</a></li>
        
          <li><a class="spec" href="/getting-started/basic-operators.html" title="Basic operators">Basic operators</a></li>
        
          <li><a class="spec" href="/getting-started/pattern-matching.html" title="Pattern matching">Pattern matching</a></li>
        
          <li><a class="spec" href="/getting-started/case-cond-and-if.html" title="case, cond and if">case, cond and if</a></li>
        
          <li><a class="spec" href="/getting-started/binaries-strings-and-char-lists.html" title="Binaries, strings and char lists">Binaries, strings and char lists</a></li>
        
          <li><a class="spec" href="/getting-started/keywords-and-maps.html" title="Keywords and maps">Keywords and maps</a></li>
        
          <li><a class="spec" href="/getting-started/modules-and-functions.html" title="Modules and Functions">Modules and Functions</a></li>
        
          <li><a class="spec" href="/getting-started/recursion.html" title="Recursion">Recursion</a></li>
        
          <li><a class="spec" href="/getting-started/enumerables-and-streams.html" title="Enumerables and streams">Enumerables and streams</a></li>
        
          <li><a class="spec" href="/getting-started/processes.html" title="Processes">Processes</a></li>
        
          <li><a class="spec" href="/getting-started/io-and-the-file-system.html" title="IO and the file system">IO and the file system</a></li>
        
          <li><a class="spec" href="/getting-started/alias-require-and-import.html" title="alias, require and import">alias, require and import</a></li>
        
          <li><a class="spec" href="/getting-started/module-attributes.html" title="Module attributes">Module attributes</a></li>
        
          <li><a class="spec" href="/getting-started/structs.html" title="Structs">Structs</a></li>
        
          <li><a class="spec" href="/getting-started/protocols.html" title="Protocols">Protocols</a></li>
        
          <li><a class="spec" href="/getting-started/comprehensions.html" title="Comprehensions">Comprehensions</a></li>
        
          <li><a class="spec" href="/getting-started/sigils.html" title="Sigils">Sigils</a></li>
        
          <li><a class="spec" href="/getting-started/try-catch-and-rescue.html" title="try, catch and rescue">try, catch and rescue</a></li>
        
          <li><a class="spec" href="/getting-started/typespecs-and-behaviours.html" title="Typespecs and behaviours">Typespecs and behaviours</a></li>
        
          <li><a class="spec" href="/getting-started/erlang-libraries.html" title="Erlang libraries">Erlang libraries</a></li>
        
          <li><a class="spec" href="/getting-started/where-to-go-next.html" title="Where to go next">Where to go next</a></li>
        
      </ol>
    </div>
  
    <div class="widget">
     <h3 class="widget-title">Mix and OTP</h3>
      <ol>
        
          <li><a class="spec" href="/getting-started/mix-otp/introduction-to-mix.html" title="Introduction to Mix">Introduction to Mix</a></li>
        
          <li><a class="spec" href="/getting-started/mix-otp/agent.html" title="Agent">Agent</a></li>
        
          <li><a class="spec" href="/getting-started/mix-otp/genserver.html" title="GenServer">GenServer</a></li>
        
          <li><a class="spec" href="/getting-started/mix-otp/supervisor-and-application.html" title="Supervisor and Application">Supervisor and Application</a></li>
        
          <li><a class="spec" href="/getting-started/mix-otp/ets.html" title="ETS">ETS</a></li>
        
          <li><a class="spec" href="/getting-started/mix-otp/dependencies-and-umbrella-apps.html" title="Dependencies and umbrella apps">Dependencies and umbrella apps</a></li>
        
          <li><a class="spec" href="/getting-started/mix-otp/task-and-gen-tcp.html" title="Task and gen-tcp">Task and gen-tcp</a></li>
        
          <li><a class="spec" href="/getting-started/mix-otp/docs-tests-and-with.html" title="Docs, tests and with">Docs, tests and with</a></li>
        
          <li><a class="spec" href="/getting-started/mix-otp/distributed-tasks-and-configuration.html" title="Distributed tasks and configuration">Distributed tasks and configuration</a></li>
        
      </ol>
    </div>
  
    <div class="widget">
     <h3 class="widget-title">Meta-programming in Elixir</h3>
      <ol>
        
          <li><a class="spec" href="/getting-started/meta/quote-and-unquote.html" title="Quote and unquote">Quote and unquote</a></li>
        
          <li><a class="spec" href="/getting-started/meta/macros.html" title="Macros">Macros</a></li>
        
          <li><a class="spec" href="/getting-started/meta/domain-specific-languages.html" title="Domain Specific Languages">Domain Specific Languages</a></li>
        
      </ol>
    </div>
  

  <div id="elixir-radar" class="widget">
  <h3 class="widget-title">Elixir Radar Newsletter</h3>
  <p>A weekly Elixir email newsletter with content curated by Plataformatec.</p>
  <div class="elixir-radar-cta">
    <div class="cta-copy">
      <div class="cta-title">
        Elixir Radar
      </div>
      <div class="cta-subtitle">
        weekly newsletter
      </div>
    </div>
    <div class="cta-button-container">
      <a href="http://plataformatec.com.br/elixir-radar/weekly-newsletter?utm_campaign=elixir_lang_cta&utm_medium=cta&utm_source=elixir_lang_website" class="cta-button">
        Subscribe now
      </a>
    </div>
  </div>
</div>

  <div id="distilled-by" class="widget">
  <h3 class="widget-title">Created at</h3>
  <ul>
    <li class="image"><a href="http://plataformatec.com.br" title="Plataformatec"><img src="/images/logo/plataformatec.png" alt="Plataformatec Logo" width="190" height="74" /></a></li>
  </ul>

  <p>
    <a class="spec" href="http://plataformatec.com.br">Plataformatec</a> offers consulting and development services for companies using Elixir.
  </p>
</div>

</div>

<div id="content">
  <article>
    <h1 id="module-attributes">Module attributes</h1>

<div id="toc" class="toc"></div>

<p>Module attributes in Elixir serve three purposes:</p>

<ol>
  <li>They serve to annotate the module, often with information to be used by the user or the <abbr title="Virtual Machine">VM</abbr>.</li>
  <li>They work as constants.</li>
  <li>They work as a temporary module storage to be used during compilation.</li>
</ol>

<p>Let’s check each case, one by one.</p>

<h2 id="as-annotations">As annotations</h2>

<p>Elixir brings the concept of module attributes from Erlang. For example:</p>

<div class="language-elixir highlighter-rouge"><pre class="highlight"><code><span class="k">defmodule</span> <span class="no">MyServer</span> <span class="k">do</span>
  <span class="nv">@vsn</span> <span class="m">2</span>
<span class="k">end</span>
</code></pre>
</div>

<p>In the example above, we are explicitly setting the version attribute for that module. <code class="highlighter-rouge">@vsn</code> is used by the code reloading mechanism in the Erlang <abbr title="Virtual Machine">VM</abbr> to check if a module has been updated or not. If no version is specified, the version is set to the MD5 checksum of the module functions.</p>

<p>Elixir has a handful of reserved attributes. Here are a few of them, the most commonly used ones:</p>

<ul>
  <li><code class="highlighter-rouge">@moduledoc</code> - provides documentation for the current module.</li>
  <li><code class="highlighter-rouge">@doc</code> - provides documentation for the function or macro that follows the attribute.</li>
  <li><code class="highlighter-rouge">@behaviour</code> - (notice the British spelling) used for specifying an <abbr title="Open Telecom Platform">OTP</abbr> or user-defined behaviour.</li>
  <li><code class="highlighter-rouge">@before_compile</code> - provides a hook that will be invoked before the module is compiled. This makes it possible to inject functions inside the module exactly before compilation.</li>
</ul>

<p><code class="highlighter-rouge">@moduledoc</code> and <code class="highlighter-rouge">@doc</code> are by far the most used attributes, and we expect you to use them a lot. Elixir treats documentation as first-class and provides many functions to access documentation. You can read more about <a href="https://hexdocs.pm/elixir/writing-documentation.html">writing documentation in Elixir in our official documentation</a>.</p>

<p>Let’s go back to the <code class="highlighter-rouge">Math</code> module defined in the previous chapters, add some documentation and save it to the <code class="highlighter-rouge">math.ex</code> file:</p>

<div class="language-elixir highlighter-rouge"><pre class="highlight"><code><span class="k">defmodule</span> <span class="no">Math</span> <span class="k">do</span>
  <span class="nv">@moduledoc</span> <span class="sd">"""
  Provides math-related functions.

  ## Examples

      iex&gt; Math.sum(1, 2)
      3

  """</span>

  <span class="nv">@doc</span> <span class="sd">"""
  Calculates the sum of two numbers.
  """</span>
  <span class="k">def</span> <span class="n">sum</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">),</span> <span class="k">do</span><span class="p">:</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>
<span class="k">end</span>
</code></pre>
</div>

<p>Elixir promotes the use of Markdown with heredocs to write readable documentation. Heredocs are multiline strings, they start and end with triple double-quotes, keeping the formatting of the inner text. We can access the documentation of any compiled module directly from IEx:</p>

<div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>elixirc math.ex
<span class="gp">$ </span>iex
</code></pre>
</div>

<pre><code class="language-iex">iex&gt; h Math # Access the docs for the module Math
...
iex&gt; h Math.sum # Access the docs for the sum function
...
</code></pre>

<p>We also provide a tool called <a href="https://github.com/elixir-lang/ex_doc">ExDoc</a> which is used to generate HTML pages from the documentation.</p>

<p>You can take a look at the docs for <a href="https://hexdocs.pm/elixir/Module.html">Module</a> for a complete list of supported attributes. Elixir also uses attributes to define <a href="/getting-started/typespecs-and-behaviours.html">typespecs</a>.</p>

<p>This section covers built-in attributes. However, attributes can also be used by developers or extended by libraries to support custom behaviour.</p>

<h2 id="as-constants">As constants</h2>

<p>Elixir developers will often use module attributes as constants:</p>

<div class="language-elixir highlighter-rouge"><pre class="highlight"><code><span class="k">defmodule</span> <span class="no">MyServer</span> <span class="k">do</span>
  <span class="nv">@initial_state</span> <span class="p">%{</span><span class="ss">host:</span> <span class="sd">"</span><span class="s2">127.0.0.1"</span><span class="p">,</span> <span class="ss">port:</span> <span class="m">3456</span><span class="p">}</span>
  <span class="no">IO</span><span class="o">.</span><span class="n">inspect</span> <span class="nv">@initial_state</span>
<span class="k">end</span>
</code></pre>
</div>

<blockquote>
  <p>Note: Unlike Erlang, user defined attributes are not stored in the module by default. The value exists only during compilation time. A developer can configure an attribute to behave closer to Erlang by calling <a href="https://hexdocs.pm/elixir/Module.html#register_attribute/3"><code class="highlighter-rouge">Module.register_attribute/3</code></a>.</p>
</blockquote>

<p>Trying to access an attribute that was not defined will print a warning:</p>

<div class="language-elixir highlighter-rouge"><pre class="highlight"><code><span class="k">defmodule</span> <span class="no">MyServer</span> <span class="k">do</span>
  <span class="nv">@unknown</span>
<span class="k">end</span>
<span class="ss">warning:</span> <span class="n">undefined</span> <span class="n">module</span> <span class="n">attribute</span> <span class="nv">@unknown</span><span class="p">,</span> <span class="n">please</span> <span class="n">remove</span> <span class="n">access</span> <span class="n">to</span> <span class="nv">@unknown</span> <span class="ow">or</span> <span class="n">explicitly</span> <span class="n">set</span> <span class="n">it</span> <span class="n">before</span> <span class="n">access</span>
</code></pre>
</div>

<p>Finally, attributes can also be read inside functions:</p>

<div class="language-elixir highlighter-rouge"><pre class="highlight"><code><span class="k">defmodule</span> <span class="no">MyServer</span> <span class="k">do</span>
  <span class="nv">@my_data</span> <span class="m">14</span>
  <span class="k">def</span> <span class="n">first_data</span><span class="p">,</span> <span class="k">do</span><span class="p">:</span> <span class="nv">@my_data</span>
  <span class="nv">@my_data</span> <span class="m">13</span>
  <span class="k">def</span> <span class="n">second_data</span><span class="p">,</span> <span class="k">do</span><span class="p">:</span> <span class="nv">@my_data</span>
<span class="k">end</span>

<span class="no">MyServer</span><span class="o">.</span><span class="n">first_data</span> <span class="c1">#=&gt; 14</span>
<span class="no">MyServer</span><span class="o">.</span><span class="n">second_data</span> <span class="c1">#=&gt; 13</span>
</code></pre>
</div>

<p>Every time an attribute is read inside a function, a snapshot of its current value is taken. In other words, the value is read at compilation time and not at runtime. As we are going to see, this also makes attributes useful to be used as storage during module compilation.</p>

<h2 id="as-temporary-storage">As temporary storage</h2>

<p>One of the projects in the Elixir organization is <a href="https://github.com/elixir-lang/plug">the <code class="highlighter-rouge">Plug</code> project</a>, which is meant to be a common foundation for building web libraries and frameworks in Elixir.</p>

<p>The Plug library also allows developers to define their own plugs which can be run in a web server:</p>

<div class="language-elixir highlighter-rouge"><pre class="highlight"><code><span class="k">defmodule</span> <span class="no">MyPlug</span> <span class="k">do</span>
  <span class="kn">use</span> <span class="no">Plug</span><span class="o">.</span><span class="no">Builder</span>

  <span class="n">plug</span> <span class="ss">:set_header</span>
  <span class="n">plug</span> <span class="ss">:send_ok</span>

  <span class="k">def</span> <span class="n">set_header</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="n">_opts</span><span class="p">)</span> <span class="k">do</span>
    <span class="n">put_resp_header</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="sd">"</span><span class="s2">x-header"</span><span class="p">,</span> <span class="sd">"</span><span class="s2">set"</span><span class="p">)</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="n">send_ok</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="n">_opts</span><span class="p">)</span> <span class="k">do</span>
    <span class="n">send</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="m">200</span><span class="p">,</span> <span class="sd">"</span><span class="s2">ok"</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="no">IO</span><span class="o">.</span><span class="n">puts</span> <span class="sd">"</span><span class="s2">Running MyPlug with Cowboy on http://localhost:4000"</span>
<span class="no">Plug</span><span class="o">.</span><span class="no">Adapters</span><span class="o">.</span><span class="no">Cowboy</span><span class="o">.</span><span class="n">http</span> <span class="no">MyPlug</span><span class="p">,</span> <span class="p">[]</span>
</code></pre>
</div>

<p>In the example above, we have used the <code class="highlighter-rouge">plug/1</code> macro to connect functions that will be invoked when there is a web request. Internally, every time you call <code class="highlighter-rouge">plug/1</code>, the Plug library stores the given argument in a <code class="highlighter-rouge">@plugs</code> attribute. Just before the module is compiled, Plug runs a callback that defines a function (<code class="highlighter-rouge">call/2</code>) which handles HTTP requests. This function will run all plugs inside <code class="highlighter-rouge">@plugs</code> in order.</p>

<p>In order to understand the underlying code, we’d need macros, so we will revisit this pattern in the meta-programming guide. However the focus here is on how using module attributes as storage allows developers to create DSLs.</p>

<p>Another example comes from <a href="https://hexdocs.pm/ex_unit/">the ExUnit framework</a> which uses module attributes as annotation and storage:</p>

<div class="language-elixir highlighter-rouge"><pre class="highlight"><code><span class="k">defmodule</span> <span class="no">MyTest</span> <span class="k">do</span>
  <span class="kn">use</span> <span class="no">ExUnit</span><span class="o">.</span><span class="no">Case</span>

  <span class="nv">@tag</span> <span class="ss">:external</span>
  <span class="n">test</span> <span class="sd">"</span><span class="s2">contacts external service"</span> <span class="k">do</span>
    <span class="c1"># ...</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
</div>

<p>Tags in ExUnit are used to annotate tests. Tags can be later used to filter tests. For example, you can avoid running external tests on your machine because they are slow and dependent on other services, while they can still be enabled in your build system.</p>

<p>We hope this section shines some light on how Elixir supports meta-programming and how module attributes play an important role when doing so.</p>

<p>In the next chapters we’ll explore structs and protocols before moving to exception handling and other constructs like sigils and comprehensions.</p>

  </article><!-- .hfeed -->

  <div id="edit-on-github">
    <span>Is something wrong?</span>
    <a href="/edit/master/ja/getting-started/module-attributes.markdown">
      Edit this page on GitHub.
    </a>
  </div>

  
  
  
  
  

  
  
    
  
    
  
    
  

</div><!-- #content -->

      </div><!-- #main -->

      <div class="clear"></div>

      <div id="copyright">
        &copy; 2012–2017 <a href="http://plataformatec.com.br/">Plataformatec</a>. All rights reserved.
      </div>
    </div><!-- .wrap -->
  </div><!-- #container -->

  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <script src="/js/toc/toc.js" type="text/javascript" charset="utf-8"></script>
  <script type="text/javascript">
    $(document).ready(function() {
      $('.toc').toc({
        title: '',
        listType: 'ol',
        minimumHeaders: 2,
        headers: 'h2, h3, h4, h5, h6',
        linkHere: true,
        linkHereTitle: 'Link here',
        backToTop: true,
        backToTopId: 'toc',
        backToTopTitle: 'Back to Table of Contents',
      });
      $('.jekyll-toc-header a.jekyll-toc-link-here span.jekyll-toc-icon').addClass('icon icon-link');
      $('.jekyll-toc-header a.jekyll-toc-back-to-top span.jekyll-toc-icon').addClass('icon icon-chevron-up');
    });
  </script>
</body>
</html>

